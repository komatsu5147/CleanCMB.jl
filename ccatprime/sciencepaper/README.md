# Measuring CMB foregrounds to aid the search for primordial gravitational waves

You can reproduce the results in Section 6 of the CCAT-prime science forecast paper. To reproduce Figure 6 and 7, use [PlotFigure6.jl](https://github.com/komatsu5147/CleanCMB.jl/tree/master/ccatprime/sciencepaper/PlotFigure6.jl) and  [PlotFigure7.jl](https://github.com/komatsu5147/CleanCMB.jl/tree/master/ccatprime/sciencepaper/PlotFigure7.jl), respectively. They will read in the data files provided in [sosat/](https://github.com/komatsu5147/CleanCMB.jl/tree/master/ccatprime/sciencepaper/sosat) and [sosatfyst/](https://github.com/komatsu5147/CleanCMB.jl/tree/master/ccatprime/sciencepaper/sosatfyst):
- `beta_results.csv` (generated by `ComputeBeta.jl`): The best-fitting values of the foreground parameters (synchrotron index `βs`, dust index `βd`, dust temperature `Td`).
- `milca_results.csv` (generated by `PerformMILCA.jl`): The best-fitting tensor-to-scalar ratio parameters `r` without and with marginalisation over the residual foreground power spectrum.

There are two additional codes in [sosatfyst/](https://github.com/komatsu5147/CleanCMB.jl/tree/master/ccatprime/sciencepaper/sosatfyst): `ComputeBetaKO.jl` and `PerformMILCAKO.jl`, which remove information from low multipoles (`ℓ<=ℓko`) of the Prime-Cam data.

While not used for the figures, `ilc_results.csv` (generated by `PerformILC.jl`) contains `r` derived from the internal linear combination (ILC) method for comparison.

These data files are high-level products of the simulation data, which were generated by [data/GenerateCovMatrices.jl](https://github.com/komatsu5147/CleanCMB.jl/tree/master/ccatprime/sciencepaper/data/GenerateCovMatrices.jl). This code requires [Healpix.jl](https://github.com/ziotom78/Healpix.jl) and [Libsharp.jl](https://github.com/ziotom78/Libsharp.jl). It also calls python wrappers [pymaster](https://github.com/LSSTDESC/NaMaster) and [classy](https://github.com/lesgourg/class_public/wiki/Python-wrapper) via `PyCall`. See "Splitting Pipelines" on [this page](https://github.com/komatsu5147/CleanCMB.jl#splitting-pipelines) for the explanation. 

## Acknowledgment

This work was supported in part by the Deutsche Forschungsgemeinschaft (DFG, German Research Foundation) under Germany's Excellence Strategy - EXC-2094 - 390783311 and JSPS KAKENHI Grant Number JP15H05896.
